# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java

trigger:
- main

pool:
  name: LocalAGPL
  Image: LocalMachine

steps:
- task: Maven@3
  inputs:
    mavenPomFile: 'pom.xml'
    mavenOptions: '-Xmx3072m'
    javaHomeOption: 'JDKVersion'
    jdkVersionOption: '1.8'
    jdkArchitectureOption: 'x64'
    publishJUnitResults: false
    testResultsFiles: '**/surefire-reports/TEST-*.xml'
    goals: 'package'

- task: ArchiveFiles@2
  inputs:
    rootFolderOrFile: '$(build.artifactstagingdirectory)/target' 
    includeRootFolder: true 
    archiveType: 'zip'
    archiveFile: 'amol.zip' 
    replaceExistingArchive: true 

  

# - task: CopyFiles@2
#   inputs:
#     SourceFolder: '$(agent.builddirectory)'
#     Contents: '**'
#     TargetFolder: '$(build.artifactstagingdirectory)'
  
# - task: PublishPipelineArtifact@1
#   inputs:
#     targetPath: '$(Pipeline.Workspace)'
#     publishLocation: 'pipeline'

#- task: PublishBuildArtifacts@1
#  inputs:
#    PathtoPublish: '$(Build.ArtifactStagingDirectory)'
#    FileCopyOptions: zip
#    ArtifactName: 'drop'
#    publishLocation: 'Container'
